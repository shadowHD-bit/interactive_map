 
let placesGroup = [
    {
        category: 'Общепит',
        style: "islands#violetIcon",
        color: 'violet',
        places: [
            {coordinates: [56.478094, 84.950290], adress: 'Проспект Ленина, 85а', info:'Decs1', name: 'Make Love Pizza'},
            {coordinates: [56.483895, 84.982243], adress: 'Комсомольский проспект, 14а', info:'Decs1', name: 'Make Love Pizza'},
            {coordinates: [56.464510, 84.984812], adress: 'Проспект Кирова, 58', info:'Decs1', name: 'Мир'},
            {coordinates: [56.491767, 84.970295], adress: 'Улица Яковлева, 42', info:'Decs1', name: 'ОШ'},
            {coordinates: [56.492875, 84.951287], adress: 'Улица Розы Люксембург, 19', info:'Decs1', name: 'ОШ'},
            {coordinates: [56.456756,84.952059], adress: 'Проспект Ленина, 1, стр. 1', info:'Decs1', name: 'ОШ'},
            {coordinates: [56.460497,84.945924], adress: 'Улица Тимакова 19А', info:'Decs1', name: 'ОШ'},
            {coordinates: [56.467499,84.964007], adress: 'Улица Вершинина, 30', info:'Decs1', name: 'ОШ'},
            {coordinates: [56.458746, 84.962255], adress: 'Улица Учебная, 37Б/1', info:'Decs1', name: 'Ростовская шаурма'},
            {coordinates: [56.503364, 85.012597], adress: 'Улица Иркутский тракт, 37', info:'Decs1', name: 'Ростовская шаурма'},
            {coordinates: [56.460899, 84.964546], adress: 'Улица Вершинина, 46/4', info:'Decs1', name: 'Ням-ням'},
            {coordinates: [56.502614, 85.003964], adress: 'Улица Иркутский тракт, 12', info:'Decs1', name: 'Бублик'},
            {coordinates: [56.459218, 84.951556], adress: 'Улица Учебная, 20', info:'Decs1', name: 'Мир суши'},
            {coordinates: [56.493427, 84.949760], adress: 'Переулок 1905 года, 11', info:'Decs1', name: 'Мир суши'},
            {coordinates: [56.476543, 84.967106], adress: 'Проспект Фрунзе, 86', info:'Decs1', name: 'Панда'},
            {coordinates: [56.458452, 84.973035], adress: 'Улица Красноармейская, 128', info:'Decs1', name: 'Панда'},
            {coordinates: [56.462526, 84.965983], adress: 'Улица Красноармейская, 101А', info:'Decs1', name: 'ШашлыкоFF'},
            {coordinates: [56.475563, 84.986474], adress: 'Проспект Фрунзе, 103 Д', info:'Decs1', name: 'ШашлыкоFF'},
            {coordinates: [56.469110, 84.951404], adress: 'Проспект Ленина, 51А', info:'Decs1', name: 'KFC'},
            {coordinates: [56.456945, 84.960728], adress: 'Улица Нахимова, 8с13', info:'Decs1', name: 'KFC'},
            {coordinates: [56.488522, 84.978551], adress: 'Комсомольский проспект, 13Б', info:'Decs1', name: 'KFC'},
            {coordinates: [56.455856, 84.973736], adress: 'Улица Красноармейская, 123А', info:'Decs1', name: 'Макдональдс'},
            {coordinates: [56.488522, 84.978551], adress: 'Комсомольский проспект, 13Б', info:'Decs1', name: 'Макдональдс'},
            {coordinates: [56.475852, 84.972667], adress: 'Проспект Фрунзе, 61', info:'Decs1', name: 'Буланже'},
            {coordinates: [56.493084, 84.949113], adress: 'Проспект Ленина, 133', info:'Decs1', name: 'Буланже'},
            {coordinates: [56.458681, 84.955769], adress: 'Улица Учебная, 35Г', info:'Decs1', name: 'Буланжери'},
            {coordinates: [56.464336, 84.954260], adress: 'Улица Усова 4', info:'Decs1', name: 'Зеленая улица'},
            {coordinates: [56.461059, 84.950451], adress: 'Проспект Ленина, 22', info:'Decs1', name: 'Дыхание ВОКА'},
            {coordinates: [56.453936, 84.975982], adress: 'Улица Красноармейская, 135', info:'Decs1', name: 'А мы тут всё плюшками балуемся'},
            {coordinates: [56.454717, 84.973376], adress: 'Улица Нахимова, 15', info:'Decs1', name: 'Сибирские блины'},
            {coordinates: [56.451374, 84.968076], adress: 'Проезд Вершинина, 8', info:'Decs1', name: 'Сибирские блины'},
            {coordinates: [56.463461, 84.952095], adress: 'Улица Усова, 1', info:'Decs1', name: 'Сибирские блины'},
            {coordinates: [56.455602, 84.951871], adress: 'Проспект Ленина, 1В', info:'Decs1', name: 'Мама я дома'}
        ]
    },
    {
        category: 'Культурные места',
        style: "islands#redIcon",
        color: 'red',
        places: [
            {coordinates: [56.488875, 84.952742], adress: 'Улица Бакунина, 3', info:'Decs1', name: 'Музей истории города Томск'},
 		    {coordinates: [56.482662, 84.947406], adress: '​Переулок Нахановича, 3', info:'Decs1', name: 'Томский областной художественный музей'},
            {coordinates: [56.483164, 84.9464], adress: '​Переулок Нахановича, 4', info:'Decs1', name: 'Театр юного зрителя'},
            {coordinates: [56.486842, 84.949966], adress: '​Площадь Ленина, 12А', info:'Decs1', name: 'Томская областная филармония'},
            {coordinates: [56.487573, 84.947334], adress: '​Площадь Ленина, 4', info:'Decs1', name: 'Театр драмы'},
            {coordinates: [56.475882, 84.949805], adress: '​Проспект Ленина, 44', info:'Decs1', name: 'Музей следственная тюрьма НКВД'},
            {coordinates: [56.482662, 84.948448], adress: 'Проспект Ленина, 78', info:'Decs1', name: 'Зрелищный центр Аэлита'},
            {coordinates: [56.454115038934084, 84.99614291661064], adress: '​Ботанический переулок', info: 'Decs1', name: 'Ботанический сад'},
            {coordinates: [56.476612, 84.950721], adress: '​Проспект Ленина, 75', info: 'Decs1', name: 'Краеведческий музей'},
            {coordinates: [56.49134, 84.987669], adress: 'Михайловская роща', info: 'Decs1', name: 'Михайловская роща'},
            {coordinates: [56.48809, 85.027976], adress: '​ул Поселок Хромовка, 60', info: 'Decs1', name: 'Памятник Федору Томскому'},
            {coordinates: [56.46735, 84.955293], adress: '​ул. Кузнецова, 30', info: 'Decs1', name: 'Профессорская квартира'},
            {coordinates: [56.488075, 84.956838], adress: '​ул. Шишкова, 10', info: 'Decs1', name: 'Томский литературный музей им. В.Я. Шишкова'},
            {coordinates: [56.476612, 84.950721], adress: '​Проспект Ленина, 75', info: 'Decs1', name: 'Краеведческий музей'},
        ]
    },
    {
        category: 'Достопримечательности',
        style: "islands#greenIcon",
        color: 'green',
        places: [
            {coordinates: [56.462471, 84.942681], adress: 'Улица Аркадия Иванова, 18А', info:'Decs1', name: 'Аллея Пивоваров'},
            {coordinates: [56.493919, 84.954647], adress: 'Улица Октябрьский Взвоз, 10', info: 'Decs1', name: 'Воскресенская церковь'},
            {coordinates: [56.486126, 84.950425], adress: 'наб. реки Ушайки, 18', info: 'Decs1', name: 'Набережная' },
            {coordinates: [56.453702, 84.948017], adress: 'Лагерный сад', info: 'Decs1', name: 'Вечный огонь' },
            {coordinates: [56.474047, 84.951727], adress: 'Ново-Соборная площадь', info: 'Decs1', name: 'Памятник студенчеству Томска'},
            {coordinates: [56.489819, 84.943633], adress: 'Набережная реки Томь', info: 'Decs1', name: 'Памятник Чехову'},
            {coordinates: [56.48690738087555, 84.94626597183485], adress: 'Площадь Ленина', info: 'Decs1', name: 'Памятник 400-летию Томска'},
            {coordinates: [56.47728228868179, 84.95046149006305], adress: 'Проспект Ленина, 77А', info: 'Decs1', name: 'Памятник А.С. Пушкину'},
            {coordinates: [56.467025616045476, 84.98041678055985], adress: 'Комсомольский проспект, 79', info: 'Decs1', name: 'Мемориал создателям космической техники'},
            {coordinates: [56.472926, 84.952922], adress: 'Ново-Соборная площадь', info: 'Decs1', name: 'Памятник женщине и подростку, ковавшим Победу в тылу'},
            {coordinates: [56.488137, 84.948587], adress: 'Площадь Ленина', info: 'Decs1', name: 'Памятник В.И. Ленину'},
            {coordinates: [56.47730046529425, 84.99189055124225], adress: 'ул. Шевченко', info: 'Decs1', name: 'Памятник Счастью'},
            {coordinates: [56.47681194417685, 84.99243901428883], adress: 'ул. Шевченко', info: 'Decs1', name: 'Памятник "Семейные узы"'},
            {coordinates: [56.46919868945546, 84.94856002341992], adress: 'Университетская роща', info: 'Decs1', name: 'Памятник "Профессорам В.М. Флоринскому и Д.И. Менделееву от благодарных сибиряков"'},
        ]
    },
    {
        category: 'Развлечения',
        style: "islands#yellowIcon",
        color: 'yellow',
        places: [
            {coordinates: [56.451896, 84.977491], adress: 'ул. 19 Гвардейской дивизии, 7', info: 'Клуб с настольными играми, чаем и печеньками', name: 'Time4friends'},
            {coordinates: [56.478526, 84.949508], adress: 'Проспект Ленина, 54А', info: 'Decs1', name: 'Компьютерный клуб Colezium'},
            {coordinates: [56.481385, 84.949607], adress: 'Проспект Ленина, 95', info: 'Decs1', name: 'Jawsspot'},
            {coordinates: [56.484004, 84.948466], adress: 'Проспект Ленина, 80А', info: 'Decs1', name: 'Time Public'},
            {coordinates: [56.488522, 84.978551], adress: 'Комсомольский проспект, 13Б', info: 'Decs1', name: 'Изумрудный город'},
            {coordinates: [56.453702, 84.948017], adress: 'Нахимова', info: 'Decs1', name: 'Лагерный сад'},
            {coordinates: [56.469791, 84.973269], adress: 'ул. Тверская, 92', info: '«Cat Space» - это мурчальное пространство, где можно собраться с друзьями, устроить необычное свидание с любимым человеком или просто прийти одному, чтобы отдохнуть в уюте и спокойствии с пушистыми хвостами.', name: 'Cat Space'},
            {coordinates: [56.501471, 84.951709], adress: 'ул. Розы Люксембург, 73', info: 'Decs1', name: 'Кинотеатр Киномакс'},
            {coordinates: [56.476384, 84.957907], adress: 'пр. Фрунзе, 20, офис 417', info: 'Decs1', name: 'Центр экскурсий и туризма'},
            {coordinates: [56.481201, 84.949014], adress: 'пр. Ленина, 70', info: 'Decs1', name: 'Hall Bar'},
            {coordinates: [56.473301, 84.944487], adress: 'Московский тракт 6/4', info: 'Decs1', name: 'Campus Bar'},
            {coordinates: [56.451071, 84.982405], adress: 'ул. Мокрушина 1а', info: 'Decs1', name: 'White Crow'},
            {coordinates: [56.508043, 84.970619], adress: 'ул. Карла Ильмера 23а', info: 'Decs1', name: 'White Crow'},
            {coordinates: [56.509568, 85.022281], adress: 'ул. Любы Шевцовой, 15', info: 'Decs1', name: 'White Crow'},
            {coordinates: [56.458452, 84.973035], adress: 'Красноармейская улица, 128', info: 'Decs1', name: 'T-Arena'},
            {coordinates: [56.488795, 84.954], adress: 'ул. Загорная, 12', info: 'Decs1', name: 'Гончарная мастерская'},
            {coordinates: [56.452215, 85.025254], adress: 'ул. Степановская. 27', info: 'Decs1', name: 'Гончарная мастерская'},
            {coordinates: [56.462526, 84.965983], adress: 'Красноармейская улица, 101а', info: 'Decs1', name: 'Гончарная мастерская'},
            {coordinates: [56.450643, 84.975461], adress: 'ул. 19 Гвардейской дивизии, 13', info: 'Decs1', name: 'Стадион Буревестник'},
            {coordinates: [56.483641, 85.024266], adress: 'пер. Нижний, 29', info: 'Decs1', name: 'Конный клуб Баланс'},
            {coordinates: [56.475722, 84.987157], adress: 'пр. Фрунзе, 103', info: 'Decs1', name: 'Батут-центр'},
            {coordinates: [56.461059, 84.950451], adress: 'Проспект Ленина, 22', info: 'Decs1', name: 'Чайная церемония'},
            {coordinates: [56.461899, 84.950362], adress: 'Проспект Ленина, 26', info: 'Клуб виртуальной реальности', name: 'VRP'},
            {coordinates: [56.484397, 84.950505], adress: 'Батенькова, 3', info: 'Decs1', name: 'Mozaica'},
            {coordinates: [56.484407, 84.9494], adress: 'Проспект Ленина, 111', info: 'Decs1', name: 'ZEN'},
            {coordinates: [56.46729, 85.03386], adress: 'ул. Королева, 19', info: 'Decs1', name: 'Горнолыжный парк спорта и отдыха'},
            {coordinates: [56.469647, 85.037354], adress: 'ул. Королева, 11', info: 'Decs1', name: 'СРК АкадемПарк'},
            {coordinates: [56.4826034, 84.9635851], adress: 'Петропавловская ул., 1с1', info: 'Decs1', name: 'Парк'},
            {coordinates: [56.469164, 85.037004], adress: 'ул. Королева, 13', info: 'Decs1', name: 'Метелица'},
            {coordinates: [56.469164, 85.037004], adress: 'Академический проспект, 5', info: 'Decs1', name: 'Скалодром Академический'},
            {coordinates: [56.513979, 84.942942], adress: 'пр. Ленина, 217, с2', info: 'Decs1', name: 'Кинополис'},
            {coordinates: [56.488522, 84.978551], adress: 'Комсомольский проспект, 13Б', info: 'Decs1', name: 'GOODWIN cinema'},
        ]
    },
    {
        category: 'Учебные и другие корпуса',
        style: "islands#blueIcon",
        color: 'blue',
        places: [
            {coordinates: [56.474117, 84.949697], adress: 'проспект Ленина, 40', info: 'Decs1', name: 'Главный корпус ТУСУР'},
            {coordinates: [56.45315, 84.97564], adress: 'Красноармейская улица, 147', info: 'Decs1', name: 'Студенческий бизнес-инкубатор "Дружба"'},
            {coordinates: [56.454031, 84.978353], adress: 'Красноармейская улица, 146', info: 'Decs1', name: 'Учебно-лабораторный корпус'},
            {coordinates: [56.451145, 84.963773], adress: 'ул. Вершинина, 74', info: 'Decs1', name: 'Учебный корпус ФЭТ'},
            {coordinates: [56.451807, 84.961653], adress: 'ул. Вершинина, 47', info: 'Decs1', name: 'Учебный корпус РК'},
            {coordinates: [56.450717, 84.96566], adress: 'ул. Вершинина, 76', info: 'Decs1', name: 'Спорткомплекс ТУСУР'},
            {coordinates: [56.454031, 84.978353], adress: 'Краноармейская улица, 146', info: 'Decs1', name: 'Библиотека ТУСУР'},
            {coordinates: [56.451807, 84.961653], adress: 'ул. Вершинина, 47 (УК РК, ауд. 223)', info: 'Decs1', name: 'Музей радио- и электронной техники'},
            {coordinates: [56.474117, 84.949697], adress: 'проспект Ленина, 40', info: 'Decs1', name: 'Библиотека ТУСУР'},
            {coordinates: [56.474117, 84.949697], adress: 'проспект Ленина, 40(ГК, ауд. 213)', info: 'Decs1', name: 'Музей истории ТУСУР'},
            {coordinates: [56.474117, 84.949697], adress: 'проспект Ленина, 40', info: 'Decs1', name: 'Гребной бассейн, спортивная база "Сенная Курья" (гребной спорт)'},
            {coordinates: [56.450558286606324, 84.96566646794928], adress: 'ул. Вершинина, 76/1', info: 'Decs1', name: 'Спортивно-образовательный комплекс'},
            {coordinates: [56.451807, 84.961653], adress: 'ул. Вершинина, 47', info: 'Decs1', name: 'Стадион ТУСУРа'},
            {coordinates: [56.45315, 84.97564], adress: 'ул. Красноармейская, 147', info: 'Decs1', name: 'Лыжная база'},
            {coordinates: [56.451558, 84.974913], adress: 'ул. Ф.Лыткина, 18', info: 'Decs1', name: 'Хоккейная площадка'},
            {coordinates: [56.451807, 84.961653], adress: 'ул. Вершинина, 47', info: 'Decs1', name: 'Медицинский пункт ТУСУРа'},
            {coordinates: [56.472516, 84.952796], adress: 'ул. Советская, 45', info: 'Decs1', name: 'Дом учёных'},
            {coordinates: [56.450558286606324, 84.96566646794928], adress: 'ул. Вершинина, 76/1 (каб. 7)', info: 'Decs1', name: 'Управление воспитательной работы'},
        ]
    },
    {
        category: 'Общежития',
        style: "islands#orangeIcon",
        color: 'orange',
        places: [
            {coordinates: [56.451498, 84.977033], adress: 'ул. 19 Гвардейской дивизии, 9а', info: 'Decs1', name: 'Общежитие №1' },
            {coordinates: [56.466688, 84.977374], adress: 'проспект Кирова 56а', info: 'Decs1', name: 'Общежитие №3' },
            {coordinates: [56.452488, 84.973592], adress: 'ул. Ф.Лыткина, 10', info: 'Decs1', name: 'Общежитие №4' },
            {coordinates: [56.451558, 84.974913], adress: 'ул. Ф.Лыткина, 18', info: 'Decs1', name: 'Общежитие №5' },
            {coordinates: [56.452548, 84.974895], adress: 'ул. Ф.Лыткина, 8', info: 'Decs1', name: 'Общежитие №6' },
        ]
    },

];
 
 ymaps.ready(init);
    function init(){
        let groukp = []

        var myMap = new ymaps.Map('map', {
            center: [56.474467, 84.950493],
            zoom: 5,
            controls: []
        }, { 
            //Границы карты
            restrictMapArea: [
                [56.578572, 84.807180],
                [56.396909, 85.165454]
            ]
        }),

        clusterer = new ymaps.Clusterer({
            preset: 'islands#invertedVioletClusterIcons',
            groupByCoordinates: false,
            clusterDisableClickZoom: true,
            clusterHideIconOnBalloonOpen: false,
            geoObjectHideIconOnBalloonOpen: false,

            clusterIconLayout: 'default#pieChart',
            // Радиус диаграммы в пикселях.
            clusterIconPieChartRadius: 25,
            // Радиус центральной части макета.
            clusterIconPieChartCoreRadius: 10,
            // Ширина линий-разделителей секторов и внешней обводки диаграммы.
            clusterIconPieChartStrokeWidth: 3,
            // Определяет наличие поля balloon.
            hasBalloon: true
        }),


        getPointOptions = function (color) {
            return {
                preset: color
            };
        };

        clusterer.options.set({
            gridSize: 20,
            clusterDisableClickZoom: false
        });

        clusterer.add(groukp)
        

        // Контейнер для меню.
        menu = $(`<ul class="places_tomsk"></ul>`);
        
    for (var i = 0, l = placesGroup.length; i < l; i++) {
        createMenuGroup(placesGroup[i]);
    }

    function createMenuGroup (placesGroup) {
        // Пункт меню.
        var menuItem = $('<li class="main_li"><a>' + placesGroup.category + '</a></li>'),
        // Коллекция для геообъектов группы.
            collection = new ymaps.GeoObjectCollection(null, { preset: placesGroup.style }),
        // Контейнер для подменю.
            submenu = $('<ul class="places_tomsk_sub"></ul>');
            
            
        // Добавляем коллекцию на карту.
        myMap.geoObjects.add(collection);
        
        // Добавляем подменю.
        menuItem
            .append(submenu)
            // Добавляем пункт в меню.
            .appendTo(menu)
            // По клику удаляем/добавляем коллекцию на карту и скрываем/отображаем подменю.
            .find('a')
            .bind('click', function () {
                if (collection.getParent()) {
                    myMap.geoObjects.remove(collection);
                    submenu.hide();
                } else {
                    myMap.geoObjects.add(collection);
                    submenu.show();
                }
            });
        for (var j = 0, m = placesGroup.places.length; j < m; j++) {
            createSubMenu(placesGroup.places[j], collection, submenu, placesGroup);
        }
    }


    function createSubMenu (item, collection, submenu, group) {
        // Пункт подменю.
        var submenuItem = $('<li><a>' + item.name + '</a></li>'),
        // Создаем метку.
            placemark = new ymaps.Placemark(item.coordinates, 
                { 
                    balloonContentHeader: item.name,
                    balloonContentBody: item.info,
                    balloonContentFooter: item.adress,
                },
                getPointOptions(group.style)
            );

        // Добавляем метку в коллекцию.
        
        groukp.push(placemark)
        
        collection.add(placemark);
        // Добавляем пункт в подменю.
        


        submenuItem
            .appendTo(submenu)
            // При клике по пункту подменю открываем/закрываем баллун у метки.
            .find('a')
            .bind('click', function () {
                myMap.setCenter(item.coordinates,15)
                if (!placemark.balloon.isOpen()) {
                    placemark.balloon.open();
                } else {
                    placemark.balloon.close();
                }
                return false;

            });
    }

    // Добавляем меню в тэг BODY.
    menu.appendTo($('.listGroup'));
    // Выставляем масштаб карты чтобы были видны все группы.

    myMap.setBounds(myMap.geoObjects.getBounds());
}


